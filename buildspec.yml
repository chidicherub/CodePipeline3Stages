version: 0.2

phases:
  install:
    runtime-versions:
      python: 3.9 # installs python 3.9
      cfn-lint: v1 
      # you can add commands section to install if you want to directly input installation code for python and cfn-lint
      # pip3 install cfn-lint
      # 
    finally:
      - echo This always runs even if the installing runtime-versions fails
  pre_build:
    commands:
      - echo ===check version of python installed===
      - python3 --version
      - echo ===check cfn-lint version===
      - cfn-lint --version
    finally:
      - echo This always runs even if the command fails
  build:
    commands:
      - echo Entered the build phase...
      - echo ===check for cloudformation template==
      - ls -l
      - echo == run cfn-lint on template in file== # this command helps check template for errors
      - cfn-lint ec2templates.yaml
      - echo == build template artifact for next stage==
      - aws cloudformation package --template-file ec2templates.yaml --s3-bucket julytrainbucket --output-template-file CF-source-artifact.yaml
    finally:
      - echo This runs the build command even if it falls
  post_build:
    commands:
      - echo Entered the post_build phase...
      - echo Build completed on `date`


artifacts:
  files:
    - CF-source-artifact.yaml
  

